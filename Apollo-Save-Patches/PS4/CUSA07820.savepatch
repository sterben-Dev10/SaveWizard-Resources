;CUSA07820
;PS4 The Last of Us Part II
;source: xdgmods.com forum
;Automated & simplified file by @officialahmed0
;decryption/checksums: by bucanero

:USR-DATA

[Decrypt USR-DATA (Required)]
set [end]:read(0x08, 4)
set [end]:endian_swap
set range:0x000010,[end]+0x0F
DECRYPT blowfish_ecb("(SH[@2>r62%5+QKpy|g6")

[Update 1.05/Max Points]
20001150 00000000
10001AB0 00000207

[All Concept Art Purchased]
20001370 0000003F
20001460 FFFFFFFE

[All Models Purchased]
200012E0 6FB79B3F
20001478 0007DFC1
20001480 FEFF7FFF

[Infinite Silencer (Ellie + Abby) *Silencer Must Be Equipped Before Adding Cheat & ‘Load Game’ Must Be Selected]
80010010 5A896447
3E303014 00000000
00000000 00000000
28000018 000000FF
80020010 5A896447
3E303014 00000000
00000000 00000000
28000018 000000FF

[All Character Upgrades (Gives Ellie 6 HP Bars)]
A00071D0 00000008
FFFFFFFF FFFFFFFF
A00072E0 00000008
FFFFFFFF FFFFFFFF

[Max Melee Durability (ANY Weapon) *Must Have Weapon On Inventory]
80010010 F52C8095
1BF61EB4 9370C643
C793FDAD 00000000
28000060 7FFFFFFF
28000068 7FFFFFFF
28000070 00000001
80020010 F52C8095
1BF61EB4 9370C643
C793FDAD 00000000
28000060 7FFFFFFF
28000068 7FFFFFFF
28000070 00000001
80030010 F52C8095
1BF61EB4 9370C643
C793FDAD 00000000
28000060 7FFFFFFF
28000068 7FFFFFFF
28000070 00000001
80040010 F52C8095
1BF61EB4 9370C643
C793FDAD 00000000
28000060 7FFFFFFF
28000068 7FFFFFFF
28000070 00000001
80050010 F52C8095
1BF61EB4 9370C643
C793FDAD 00000000
28000060 7FFFFFFF
28000068 7FFFFFFF
28000070 00000001
80060010 F52C8095
1BF61EB4 9370C643
C793FDAD 00000000
28000060 7FFFFFFF
28000068 7FFFFFFF
28000070 00000001

; by @officialahmed0
[Weapon swap bow to tommy's rifle for Ellie]
80010020 861B638E
BAADBCC4 6C30D500
85A901F8 6969B1A2
7EFE1381 11313532
D784E928 00000000
8801000C 00000000
63074F2B 37693E25
A8000004 00000008
BA732505 B3E6FB0F
A800000C 00000008
AB64CF42 AE45072A
A8000014 00000010
01000000 00000000
E7030000 00000000
88010024 00000000
00000000 00000000
00000000 00000000
00000000 00000000
00000000 01010101
A8000000 00000008
AB64CF42 AE45072A
A8000010 00000008
E7030000 00000000
88010020 A878BA47
C180EF9D 88AB60C0
BEBDCEC3 4656EEB1
6B2E8CE6 2FE35366
EFF9BB68 00000000
63074F2B 37693E25
GGGGGGGG 00000000
A8000000 00000008
BA732505 B3E6FB0F
88010010 C03A5CB5
072EB708 193DC7D0
9B27D7DE 00000000
88010008 XXXXXXXX
GGGGGGGG 00000000
A8000000 00000008
BA732505 B3E6FB0F

; by @officialahmed0
[Weapon swap bow to tommy's rifle for Abby]
80040020 861B638E
BAADBCC4 6C30D500
85A901F8 6969B1A2
7EFE1381 11313532
D784E928 00000000
8801000C 00000000
63074F2B 37693E25
A8000004 00000008
BA732505 B3E6FB0F
A800000C 00000008
AB64CF42 AE45072A
A8000014 00000010
01000000 00000000
E7030000 00000000
88010024 00000000
00000000 00000000
00000000 00000000
00000000 00000000
00000000 01010101
A8000000 00000008
AB64CF42 AE45072A
A8000010 00000008
E7030000 00000000
88010020 A878BA47
C180EF9D 88AB60C0
BEBDCEC3 4656EEB1
6B2E8CE6 2FE35366
EFF9BB68 00000000
63074F2B 37693E25
GGGGGGGG 00000000
A8000000 00000008
BA732505 B3E6FB0F
88010010 C03A5CB5
072EB708 193DC7D0
9B27D7DE 00000000
88010008 XXXXXXXX
GGGGGGGG 00000000
A8000000 00000008
BA732505 B3E6FB0F

[ELLIE WEAPON SWAP CODE: BOLT ACTON RIFLE – SILENCER ONLY]
80010020 861B638E
BAADBCC4 6C30D500
85A901F8 6969B1A2
7EFE1381 11313532
D784E928 00000000
8801000C 00000000
FBFE319A C84B89E2
A8000004 00000008
DA8B94C4 1D76CA5D
A800000C 00000008
DA8B94C4 1D76CA5D
A8000014 00000010
01000000 00000000
E7030000 00000000
88010024 00000000
00000000 00000000
00000000 00000000
00000000 00000000
00000000 01010101
A8000000 00000008
DA8B94C4 1D76CA5D
A8000010 00000008
E7030000 00000000
88010020 A878BA47
C180EF9D 88AB60C0
BEBDCEC3 4656EEB1
6B2E8CE6 2FE35366
EFF9BB68 00000000
88010008 FBFE319A
C84B89E2 00000000
A8000000 00000008
DA8B94C4 1D76CA5D
88010010 C03A5CB5
072EB708 193DC7D0
9B27D7DE 00000000
88010008 FBFE319A
C84B89E2 00000000
A8000000 00000008
DA8B94C4 1D76CA5D


; Castagnoli CRC32
[Update CRC32-C checksum for USR-DATA (Required)]
set [block_length]:read(0x594,4)
set [block_length]:endian_swap
set [block_length]:[block_length]+0x58F
set range:0x594,[block_length]
set crc_bandwidth:32
set crc_polynomial:0x1EDC6F41
set crc_initial_value:0xFFFFFFFF
set crc_output_xor:0xFFFFFFFF
set crc_reflection_input:1
set crc_reflection_output:1
set [hash]:crc
set [hash]:endian_swap
write at 0x590:[hash]

[Update HMAC SHA1 checksum for USR-DATA (Required)]
set pointer:EOF-0x1F
set range:0x000010,pointer
set [hash]:hmac_sha1("xM;6X%/p^L/:}-5QoA+K8:F*M!~sb(WK<E%6sW_un0a[7Gm6,()kHoXY+yI/s;Ba")
write next (0):[hash]

[Encrypt USR-DATA (Required)]
set [end]:read(0x08, 4)
set [end]:endian_swap
set range:0x000010,[end]+0x0F
ENCRYPT blowfish_ecb("(SH[@2>r62%5+QKpy|g6")
